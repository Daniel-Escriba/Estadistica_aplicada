---
title: "LAB 9"
author: "ARANDA"
date: "2025-05-16"
output:
  pdf_document: default
  html_document: default
---



#SEMANA 9: Prueba de hip√≥tesis para validar un modelo multilineal.

###1 Situacion presentada:
###El Times-Observer es un peri√≥dico en la ciudad Metro. Al igual que muchos peri√≥dicos en la ciudad, el Times-Observer pasa por dificultades financieras. La gerente de circulaci√≥n estudia otros peri√≥dicos en ciudades similares en Estados Unidos y Canad√°, con inter√©s particular en las variables que se relacionan con el n√∫mero de suscriptores. Esta re√∫ne la informacion muestral de 25 peri√≥dicos en ciudades similares empleando la siguiente notaci√≥n:

```{r}
#Suscriptores: N√∫mero de suscriptores (en miles)
#Poblaci√≥n: Poblaci√≥n metropolitana (en miles)
#Presupuesto: Presupuesto en publicidad del peri√≥dico (en miles de d√≥lares)
#Ingreso: Ingreso familiar medio en el √°rea metropolitana (en miles de d√≥lares)
#Deseando predecir el n√∫mero de suscriptores con base a las otras variables, haga lo siguiente:

# a.Lea la base de datos y haga un an√°lisis de regresi√≥n m√∫ltiple. Adem√°s, escriba la ecuaci√≥n de regresi√≥n.
# Leyendo la base de datos


```

```{r}
library(readxl)
library(pander)
library(equatiomatic)

data = read_excel("peri√≥dicos.xlsx", sheet="Hoja1")
data = data[-1]
data = as.data.frame(data)

# Usar pander para formatear la tabla
pander(data, caption = "Tabla de datos de suscripciones a periodicos de USA y Canada")
```


```{r}
#Ajuste del Modelo de regresi√≥n m√∫ltiple
```

```{r}
model = lm(formula=Suscriptores~ Poblaci√≥n + Presupuesto + Ingreso, data=data)
summary(model)
```
```{r}
#Extraemos los coeficientes


model$coefficients

```

```{r}
#Escribiendo la ecuaci√≥n de regresi√≥n
#ùõΩ0ùõΩ1ùõΩ2ùõΩ3=‚àí5.732813186=0.007536582=0.050883394=1.097380777

# Suscriptores=(‚àí5.732813186)+0.007536582‚ãÖPoblaci√≥n+0.050883394‚ãÖPresupuesto+(1.097380777)‚ãÖIngreso

```

```{r}
#b.Verifique los supuestos de linealidad e independencia y diga si se aceptan o rechazan las hip√≥tesis nula Ho.
```


```{r}
cor.test(data$Suscriptores,data$Poblaci√≥n)

```


```{r}
#El p-value = 0.0005271 < 0.05. Entonces, al 5% de significancia estadistica se rechaza la Ho de que No existe correlacion entre Suscriptores y Poblaci√≥n. Es decir, se acepta la hipotesis alternativa H1 de que existe correlacion.
```
```{r}
cor.test(data$Suscriptores,data$Presupuesto)

```


```{r}
#El p-value = 7.208e-05 < 0.05. Entonces, al 5% de significancia estadistica se rechaza la Ho de que No existe correlacion entre Suscriptores y Presupuesto. Es decir, se acepta la hipotesis alternativa H1 de que existe correlacion.


```


```{r}
cor.test(data$Suscriptores,data$ Ingreso)

```


```{r}
#El p-value = 7.016e-05 < 0.05 Entonces, al 5% de significancia estadistica se rechaza la Ho de que No existe correlacion entre Suscriptores e Ingreso. Es decir, se acepta la hipotesis alternativa H1 de que existe correlacion.

```

```{r}
library(GGally)

ggpairs(data, lower=list (continuous="smooth"),
diag=list (continuous="barDiag"), axisLabe1s="none")
```


```{r}
#Independencia

```


```{r}
library(lmtest)
dwtest(model)
```


```{r}
#El p-value = 0.7468 > 0.05. Entonces, al 5% de significancia estadistica, NO se rechaza la hipotesis nula Ho, de que No existe autocorrelacion. Es decir, NO existe autocorrelacion entre los residuos.
```

```{r}
#Grafico de los residuos
```

```{r}
plot(model$residuals)

```


```{r}
#Interpretacion:El gr√°fico de residuos muestra que est√°n bien distribuidos y no presentan patrones, lo que indica que los errores son independientes. No hay tendencias ni agrupamientos que sugieran problemas, aunque algunos puntos extremos podr√≠an ser valores at√≠picos. En general, la aleatoriedad de los residuos sugiere que el modelo es adecuado en cuanto a la independencia de los errores.
```

```{r}
#c.Verifique los supuestos de normalidad y homocedasticidad y diga si se aceptan o rechazan las hip√≥tesis nula Ho.
```


```{r}
#Normalidad
```

```{r}
shapiro.test(model$residuals)

```


```{r}
#El p-value = 0.964 > 0.05. Entonces, al 5% de significancia estadistica, NO se rechaza la hipotesis nula Ho, de que los residuos se distribuyen normalmente. Es decir, los residuos siguen una distribuyen normal.
```

```{r}
#Gr√°fico Q-Q
```

```{r}
plot(model, 2)

```
```{r}
#Interpretacion:El gr√°fico Q-Q de residuos muestra que la mayor√≠a se alinean con la l√≠nea diagonal, lo que sugiere una distribuci√≥n normal. Sin embargo, hay algunas observaciones (8, 17 y 16) que se desv√≠an, indicando posibles valores at√≠picos. En general, la normalidad de los residuos es aceptable, aunque hay ligeras desviaciones en los extremos que merecen ser investigadas.
```

```{r}
#Varianza constante(homocedasticidad)
```

```{r}
library(lmtest)

bptest(model)
```
```{r}
#El p-value = 0.3327 > 0.05. Entonces, al 5% de significancia estadistica, NO se rechaza la hipotesis nula Ho, de que los residuos tienen varianza constante.Es decir, los residuos poseen una varianza constante.
```

```{r}
#Grafico de los residuos
```

```{r}
plot(model, 1)

```

```{r}
#Interpretacion:El gr√°fico de residuos frente a valores ajustados muestra una distribuci√≥n aleatoria de los residuos alrededor de cero, lo que indica que no hay patrones sistem√°ticos y sugiere que el modelo lineal es adecuado. Sin embargo, hay algunos puntos (8, 16 y 17) que se desv√≠an, lo que puede se√±alar valores at√≠picos que necesitan m√°s an√°lisis. En general, la l√≠nea de suavizado (en rojo) se mantiene bastante plana, apoyando la homocedasticidad de los residuos.
```







































































