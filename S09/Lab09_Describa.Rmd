---
title: "Lab09: PRUEBAS DE HIP√ìTESIS PARA MODELO MULTILINEAL"
author: "Daniel Escriba Flores"
output:
  pdf_document:
    latex_engine: xelatex
    toc: true
    toc_depth: 3
  html_document: 
    toc: true
    theme: united
    toc_depth: 3
    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Contexto:

El Times-Observer es un peri√≥dico en la ciudad Metro. Al igual que muchos peri√≥dicos en la ciudad, el Times-Observer pasa por dificultades financieras. La gerente de circulaci√≥n estudia otros peri√≥dicos en ciudades similares en Estados Unidos y Canad√°, con inter√©s particular en las variables que se relacionan con el n√∫mero de suscriptores. Esta re√∫ne la informacion muestral de 25 peri√≥dicos en ciudades similares empleando la siguiente notaci√≥n:

‚Ä¢ Suscriptores : N√∫mero de suscriptores (en miles)
‚Ä¢ Poblaci√≥n : Poblaci√≥n metropolitana (en miles)
‚Ä¢ Presupuesto : Presupuesto en publicidad del peri√≥dico (en miles de d√≥lares)
‚Ä¢ Ingreso : Ingreso familiar medio en el √°rea metropolitana (en miles de d√≥lares)

Deseando predecir el n√∫mero de suscriptores con base a las otras variables, haga lo siguiente:

---

# Pregunta A: Datos, Regresion Multiple y Ecuacion

a. Lea la base de datos y haga un an√°lisis de regresi√≥n m√∫ltiple. Adem√°s, escriba la ecuaci√≥n de regresi√≥n.

## Lectura de datos

```{r Importando datos , warning=FALSE }
library(readxl)
library(pander)
library(equatiomatic)

data = read_excel("peri√≥dicos.xlsx", sheet="Hoja1")
data = data[-1]
data = as.data.frame(data)

# Usar pander para formatear la tabla
pander(data, caption = "Tabla de datos de suscripciones a periodicos de USA y Canada")
```

## Regresion Multiple

```{r}
modelo = lm(formula = Suscriptores ~ Poblaci√≥n +
              Presupuesto + 
              Ingreso, 
            data= data)

summary(modelo)

modelo$coefficients
```

## Ecuacion de Regresion


```{r, echo=FALSE}
cat("Ecuaci√≥n de regresi√≥n:\n")
cat("Suscriptores =", coef(modelo)[1], "+", coef(modelo)[2], "* Poblaci√≥n +", 
    coef(modelo)[3], "* Presupuesto +", coef(modelo)[4], "* Ingreso\n")
```

```{r}
# Versi√≥n b√°sica
extract_eq(modelo)

# Versi√≥n con valores de coeficientes
extract_eq(modelo, use_coefs = TRUE)

```

# Pregunta B: Linealidad e independecia

b. Verifique los supuestos de linealidad e independencia y diga si se aceptan o rechazan las
hip√≥tesis nula ùêª0.

## Linealidad 

```{r prueba t, message=FALSE, warning=FALSE}
cor.test(data$Suscriptores, data$Poblaci√≥n)
```
### Interpretacion 

- El valor de p-valor = 0.0005271 es menor a 0.05 , por lo tanto, se rechaza la hip√≥tesis nula (Ho) . Esto indica que existe una correlaci√≥n lineal estad√≠sticamente significativa entre la variable Suscriptores y Poblaci√≥n .

El coeficiente de correlaci√≥n es 0.643 , lo que sugiere una relaci√≥n positiva moderada a fuerte entre ambas variables.

## Independencia

```{r prueba Durbin-watson, message=FALSE, warning=FALSE}
library(lmtest)

dwtest(modelo)
```

### Interpretacion

El p-valor = 0.7468 es mayor a 0.05 , por lo tanto, no se rechaza la hip√≥tesis nula (Ho) . Esto indica que no existe autocorrelaci√≥n significativa entre los residuos del modelo. Los errores son independientes, lo cual cumple con el supuesto de independencia en regresi√≥n lineal.

# Pregunta C: Normalidad y Homocedasticidad

c. Verifique los supuestos de normalidad y homocedasticidad y diga si se aceptan o rechazan las
hip√≥tesis nula ùêª0.


## Normalidad

```{r prueba shapiro-wilk}
shapiro.test(modelo$residuals)
```

### Interpretacion

El p-valor = 0.964 es mayor a 0.05 , por lo tanto, no se rechaza la hip√≥tesis nula (Ho) . Esto indica que los residuos siguen una distribuci√≥n normal , cumpliendo as√≠ con el supuesto de normalidad en el modelo de regresi√≥n.


## Homocedasticidad

```{r prueba Breusch-Pagan}
library(lmtest)

bptest(modelo)
```

### Interpretacion

El p-valor = 0.3327 es mayor a 0.05 , por lo tanto, no se rechaza la hip√≥tesis nula (Ho) . Esto indica que los residuos tienen varianza constante , es decir, se cumple el supuesto de homocedasticidad en el modelo de regresi√≥n.
